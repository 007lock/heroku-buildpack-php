#!/bin/bash
# Build Path: /app/.heroku/php/

OUT_PREFIX=$1

# fail hard
set -o pipefail
# fail harder
set -eux

echo "Building ICU..."

echo "=== Downloading ICU source..."

dep_version=${VERSION:-52.1}
dep_dirname=icu
dep_archive_name=icu4c-${dep_version//\./_}-src.tgz

curl -LO http://download.icu-project.org/files/icu4c/${dep_version}/${dep_archive_name}
tar xzf ${dep_archive_name}
pushd ${dep_dirname}/source

echo "=== Compiling ICU..."
./runConfigureICU Linux --prefix=$OUT_PREFIX
make
make install
popd


echo "=== Cleaning up..."
rm -fr ${dep_dirname} ${dep_archive_name}


echo "Done building ICU."
